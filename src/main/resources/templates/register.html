<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Account Opening Form</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <style>
        .container {
            max-width: 600px;
            margin-top: 50px;
        }

        .form-section {
            margin-bottom: 30px;
        }


        .form-section h3 {
            margin-bottom: 20px;
        }

        .btn-primary {
            width: 100%;
        }

        .login-link {
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
<div class="container">
    <h2>Open A Saving Account</h2>
    <form id="registerForm">
        <div class="form-section">
            <div class="form-group">
                <label for="title">Title:</label>
                <select id="title" name="title" class="form-control" required>
                    <option value="MR">Mr</option>
                    <option value="MRS">Mrs</option>
                    <option value="MS">Ms</option>
                </select>
            </div>
            <div class="form-group">
                <label for="firstName">First Name:</label>
                <input type="text" id="firstName" name="firstName" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="middleName">Middle Name:</label>
                <input type="text" id="middleName" name="middleName" class="form-control">
            </div>
            <div class="form-group">
                <label for="lastName">Last Name:</label>
                <input type="text" id="lastName" name="lastName" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="fatherName">Father Name:</label>
                <input type="text" id="fatherName" name="fatherName" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="phoneNumber">Phone Number:</label>
                <input type="text" id="phoneNumber" name="phoneNumber" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="aadharNumber">Aadhar Number:</label>
                <input type="text" id="aadharNumber" name="aadharNumber" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="dateOfBirth">Date of Birth:</label>
                <input type="date" id="dateOfBirth" name="dateOfBirth" class="form-control" required>
            </div>
        </div>

        <div class="form-section">
            <h3>Residential Address</h3>
            <div class="form-group">
                <label for="addressLine1">Address Line 1:</label>
                <input type="text" id="addressLine1" name="addressLine1" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="addressLine2">Address Line 2:</label>
                <input type="text" id="addressLine2" name="addressLine2" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="landmark">Landmark:</label>
                <input type="text" id="landmark" name="landmark" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="state">State:</label>
                <input type="text" id="state" name="state" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="city">City:</label>
                <input type="text" id="city" name="city" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="pincode">Pincode:</label>
                <input type="text" id="pincode" name="pincode" class="form-control" required>
            </div>
        </div>

        <div class="form-section">
            <h3>Permanent Address</h3>
            <div class="form-group">
                <label for="permAddressLine1">Address Line 1:</label>
                <input type="text" id="permAddressLine1" name="permAddressLine1" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="permAddressLine2">Address Line 2:</label>
                <input type="text" id="permAddressLine2" name="permAddressLine2" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="permLandmark">Landmark:</label>
                <input type="text" id="permLandmark" name="permLandmark" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="permState">State:</label>
                <input type="text" id="permState" name="permState" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="permCity">City:</label>
                <input type="text" id="permCity" name="permCity" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="permPincode">Pincode:</label>
                <input type="text" id="permPincode" name="permPincode" class="form-control" required>
            </div>
        </div>

        <div class="form-section">
            <h3>Occupation Details</h3>
            <div class="form-group">
                <label for="occupationType">Occupation:</label>
                <input type="text" id="occupationType" name="occupationType" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="sourceOfIncome">Source of Income:</label>
                <input type="text" id="sourceOfIncome" name="sourceOfIncome" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="annualIncome">Annual Income:</label>
                <input type="text" id="annualIncome" name="annualIncome" class="form-control" required>
            </div>
        </div>

        <button type="submit" class="btn btn-primary">Register</button>
    </form>
    <div class="login-link">
        <p>Already have an account? <a href="/api/user/login">Login here</a></p>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
    document.getElementById('registerForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const formData = {
            title: document.getElementById('title').value,
            firstName: document.getElementById('firstName').value,
            middleName: document.getElementById('middleName').value,
            lastName: document.getElementById('lastName').value,
            fatherName: document.getElementById('fatherName').value,
            mobileNumber: document.getElementById('phoneNumber').value,
            email: document.getElementById('email').value,
            aadharNumber: document.getElementById('aadharNumber').value,
            dateOfBirth: document.getElementById('dateOfBirth').value,
            residentialAddress: {
                addressLine1: document.getElementById('addressLine1').value,
                addressLine2: document.getElementById('addressLine2').value,
                landmark: document.getElementById('landmark').value,
                state: document.getElementById('state').value,
                city: document.getElementById('city').value,
                pincode: document.getElementById('pincode').value
            },
            permanentAddress: {
                addressLine1: document.getElementById('permAddressLine1').value,
                addressLine2: document.getElementById('permAddressLine2').value,
                landmark: document.getElementById('permLandmark').value,
                state: document.getElementById('permState').value,
                city: document.getElementById('permCity').value,
                pincode: document.getElementById('permPincode').value
            },
            occupation: {
                occupationType: document.getElementById('occupationType').value,
                sourceIncome: document.getElementById('sourceOfIncome').value,
                grossAnnualIncome: document.getElementById('annualIncome').value
            }
        };

        const apiUrl = 'http://localhost:8080/api/user/register';

        fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
            .then(response => {
                if (response.ok) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Registration successful',
                        text: 'You have registered successfully!',
                        timer: 2000,
                        timerProgressBar: true,
                        showConfirmButton: false
                    }).then(() => {
                        window.location.href = '/api/user/login';
                    });
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: response.error.code,
                        text: response.error.message,
                    });
                }
            })
            .catch(error => {
                console.error('Error during registration:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Registration Error',
                    text: 'An unknown error occurred',
                });
            });
    });
</script>
</body>
</html>
